<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creator Radar - GeoVera Intelligence</title>

    <!-- TailAdmin Design System -->
    <link rel="stylesheet" href="css/tailadmin-base.css">
    <link rel="stylesheet" href="css/geovera-sidebar.css?v=2">
    <link rel="stylesheet" href="css/tailadmin-components.css">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Accessibility CSS -->
    <link rel="stylesheet" href="/css/accessibility.css">

    <style>
        /* Two-column layout for Radar (40% News + 60% Analytics) */
        .radar-two-column {
            display: grid;
            grid-template-columns: 40% 60%;
            gap: 24px;
            margin-top: 24px;
        }

        @media (max-width: 1024px) {
            .radar-two-column {
                grid-template-columns: 1fr;
            }
        }

        /* News feed styling */
        .news-item {
            padding: 16px;
            border-bottom: 1px solid #E5E7EB;
            transition: background 0.2s;
        }

        .news-item:hover {
            background: #F9FAFB;
        }

        .news-item:last-child {
            border-bottom: none;
        }

        /* Leaderboard styling */
        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-bottom: 1px solid #E5E7EB;
            transition: all 0.2s;
        }

        .leaderboard-item:hover {
            background: #F0FDF4;
            border-left: 4px solid #16A34A;
            padding-left: 8px;
        }

        .rank-badge {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }

        .rank-1 { background: #FEF3C7; color: #92400E; }
        .rank-2 { background: #E5E7EB; color: #374151; }
        .rank-3 { background: #FECACA; color: #991B1B; }
        .rank-default { background: #F9FAFB; color: #6B7280; }

        /* Heatmap grid */
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .heatmap-cell {
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            transition: transform 0.2s;
        }

        .heatmap-cell:hover {
            transform: scale(1.05);
        }

        /* Metric bars */
        .metric-bar {
            height: 6px;
            background: #E5E7EB;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 4px;
        }

        .metric-fill {
            height: 100%;
            background: #16A34A;
            transition: width 0.5s ease;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <!-- Skip to Main Content -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>
    <div role="status" aria-live="polite" aria-atomic="true" class="sr-only live-region" id="announcements"></div>

    <!-- GeoVera Layout with White Sidebar -->
    <div class="geovera-layout">

        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" aria-label="Toggle menu" onclick="toggleMobileSidebar()">
            <svg class="mobile-menu-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
        </button>

        <!-- Left Sidebar Navigation (White) -->
    <div class="geovera-sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo-container">
                <div class="logo">G</div>
                <span class="logo-text">GeoVera</span>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                </svg>
            </button>
        </div>

        <nav class="sidebar-nav">
            <a href="dashboard.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
                </svg>
                <span>Dashboard</span>
            </a>

            <a href="chat.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/>
                </svg>
                <span>AI Chat</span>
            </a>

            <a href="insights.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                    <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/>
                </svg>
                <span>Insights</span>
            </a>

            <a href="todo.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                </svg>
                <span>To Do</span>
            </a>

            <a href="radar.html" class="nav-item active">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                </svg>
                <span>Radar</span>
            </a>

            <a href="hub.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M2 6a2 2 0 012-2h12a2 2 0 012 2v2a2 2 0 100 4v2a2 2 0 01-2 2H4a2 2 0 01-2-2v-2a2 2 0 100-4V6z"/>
                </svg>
                <span>Hub</span>
            </a>

            <a href="content-studio.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
                </svg>
                <span>Content Studio</span>
            </a>

            <div class="nav-divider"></div>

            <a href="seo.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                </svg>
                <span>SEO</span>
            </a>

            <a href="geo.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z" clip-rule="evenodd"/>
                </svg>
                <span>GEO</span>
            </a>

            <a href="social-search.html" class="nav-item">
                <svg class="nav-item-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"/>
                </svg>
                <span>Social Search</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="user-menu">
                <button class="user-button" id="userMenuButton">
                    <div class="user-avatar">U</div>
                    <div class="user-info">
                        <div class="user-name" id="userName">User</div>
                        <div class="user-email" id="userEmail">user@email.com</div>
                    </div>
                    <svg class="dropdown-icon" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </button>
                <div class="user-dropdown" id="userDropdown">
                    <a href="settings.html">Settings</a>
                    <a href="#" onclick="logout()">Logout</a>
                </div>
            </div>
        </div>
    </div>


        <!-- Sidebar Overlay for Mobile -->
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeMobileSidebar()"></div>

        <!-- Main Content Area -->
        <main class="geovera-main" id="main-content" role="main">

            <!-- Page Content -->
            <div class="page-content">

                <!-- Partner-tier restriction notice -->
                <div class="card-tailadmin" style="margin-bottom: 24px; background: #FEF3C7; border-left: 4px solid #F59E0B;">
                    <div style="display: flex; align-items: start; gap: 12px;">
                        <span style="font-size: 24px;">‚ö†Ô∏è</span>
                        <div>
                            <h3 style="font-weight: 700; color: #92400E; margin-bottom: 4px;">Partner-Tier Exclusive</h3>
                            <p style="color: #78350F; font-size: 14px;" id="radar-restriction-text">Radar is available only for Partner-tier subscribers and limited to your brand's country and category.</p>
                        </div>
                    </div>
                </div>

                <!-- Two-Column Layout: 40% News + 60% Analytics -->
                <div class="radar-two-column">

                    <!-- LEFT COLUMN (40%): News Radar Feed -->
                    <div>
                        <div class="card-tailadmin" style="margin-bottom: 16px;">
                            <h2 class="card-title-tailadmin" style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 20px;">üì°</span> News Radar
                            </h2>
                            <p class="card-subtitle-tailadmin">Real-time market intelligence updates</p>
                        </div>

                        <!-- News Feed -->
                        <div class="card-tailadmin" id="news-feed">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- RIGHT COLUMN (60%): Analytics Dashboard -->
                    <div>
                        <!-- Top 100 Creators Leaderboard -->
                        <div class="card-tailadmin" style="margin-bottom: 24px;">
                            <h2 class="card-title-tailadmin" style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 20px;">üèÜ</span> Top 100 Creators
                            </h2>
                            <p class="card-subtitle-tailadmin" style="margin-bottom: 16px;">Ranked by mindshare (Quality Content √ó Quality Reach √ó Quality Engagement √ó Impact Rate)</p>

                            <!-- Tabs -->
                            <div style="display: flex; gap: 8px; margin-bottom: 16px; border-bottom: 1px solid #E5E7EB; padding-bottom: 8px;">
                                <button class="btn-primary-tailadmin btn-sm-tailadmin" onclick="switchTab('creators')">Creators</button>
                                <button class="btn-outline-tailadmin btn-sm-tailadmin" onclick="switchTab('content')">Content</button>
                            </div>

                            <div id="leaderboard-creators" style="max-height: 600px; overflow-y: auto;">
                                <!-- Populated by JavaScript -->
                            </div>

                            <div id="leaderboard-content" style="max-height: 600px; overflow-y: auto; display: none;">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Brand vs Competitor Heatmap -->
                        <div class="card-tailadmin">
                            <h2 class="card-title-tailadmin" style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 20px;">üî•</span> Brand vs Competitors
                            </h2>
                            <p class="card-subtitle-tailadmin" style="margin-bottom: 16px;">Performance heatmap (Top 500 indexed creators)</p>

                            <div id="heatmap-container">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </main>

    </div>

    <!-- Sidebar Navigation JavaScript -->
    <script>
        function toggleMobileSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
            document.getElementById('sidebarOverlay').classList.toggle('active');
        }

        function closeMobileSidebar() {
            document.getElementById('sidebar').classList.remove('active');
            document.getElementById('sidebarOverlay').classList.remove('active');
        }

        function toggleUserMenu() {
            document.getElementById('userMenu').classList.toggle('active');
        }

        async function handleLogout() {
            if (typeof supabase !== 'undefined') {
                await supabase.auth.signOut();
            }
            window.location.href = '/frontend/login.html';
        }

        document.addEventListener('click', function(event) {
            const userMenu = document.getElementById('userMenu');
            const sidebarUser = document.querySelector('.sidebar-user');
            if (userMenu && sidebarUser && !sidebarUser.contains(event.target) && !userMenu.contains(event.target)) {
                userMenu.classList.remove('active');
            }
        });

        function switchTab(tab) {
            const creatorsTab = document.getElementById('leaderboard-creators');
            const contentTab = document.getElementById('leaderboard-content');
            const buttons = event.currentTarget.parentElement.querySelectorAll('button');

            if (tab === 'creators') {
                creatorsTab.style.display = 'block';
                contentTab.style.display = 'none';
                buttons[0].className = 'btn-primary-tailadmin btn-sm-tailadmin';
                buttons[1].className = 'btn-outline-tailadmin btn-sm-tailadmin';
            } else {
                creatorsTab.style.display = 'none';
                contentTab.style.display = 'block';
                buttons[0].className = 'btn-outline-tailadmin btn-sm-tailadmin';
                buttons[1].className = 'btn-primary-tailadmin btn-sm-tailadmin';
            }
        }
    </script>

    <!-- Supabase & Config -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/frontend/config.js" type="module"></script>
    <script type="module">
        import config from '/frontend/config.js';
        const supabase = window.supabase.createClient(config.supabase.url, config.supabase.anonKey);

        // Mock data for demonstration
        const mockNews = [
            { type: 'mention', icon: 'üì¢', title: 'Total Mentions Spike', description: 'Your brand mentioned 247 times today (+42% vs yesterday)', trend: 'up', value: '+42%' },
            { type: 'share', icon: 'üìä', title: 'Market Share Update', description: 'You own 18.5% of beauty category mindshare', trend: 'up', rank: '#3', change: '‚Üë 2' },
            { type: 'star', icon: '‚≠ê', title: 'Rising Star Creator', description: '@BeautyByMaya gained 15K followers (24h)', followers: '125K', engagement: '4.2%' },
            { type: 'competitor', icon: '‚ö†Ô∏è', title: 'Competitor Alert', description: 'Rival Brand X launched campaign with @TopInfluencer', impact: 'High' },
            { type: 'trend', icon: 'üìà', title: 'Trending Hashtag', description: '#SustainableBeauty trending in your market (+120%)', posts: '1.2K' }
        ];

        const mockCreators = [
            { rank: 1, name: '@BeautyGuru', category: 'Beauty', mindshare: 95, qContent: 92, qReach: 98, qEngagement: 90, impact: 96 },
            { rank: 2, name: '@MakeupQueen', category: 'Beauty', mindshare: 88, qContent: 85, qReach: 90, qEngagement: 88, impact: 90 },
            { rank: 3, name: '@SkinCarePro', category: 'Skincare', mindshare: 82, qContent: 88, qReach: 80, qEngagement: 85, impact: 78 },
            { rank: 4, name: '@GlowUpDaily', category: 'Beauty', mindshare: 78, qContent: 75, qReach: 82, qEngagement: 80, impact: 75 },
            { rank: 5, name: '@NaturalVibes', category: 'Wellness', mindshare: 72, qContent: 70, qReach: 75, qEngagement: 72, impact: 71 }
        ];

        const mockContent = [
            { rank: 1, title: 'Summer Glow Tutorial', creator: '@BeautyGuru', velocity: 98, reach: '2.5M', engagement: '8.2%' },
            { rank: 2, title: '10-Minute Morning Routine', creator: '@MakeupQueen', velocity: 92, reach: '1.8M', engagement: '7.5%' },
            { rank: 3, title: 'Sustainable Beauty Haul', creator: '@NaturalVibes', velocity: 85, reach: '950K', engagement: '9.1%' },
            { rank: 4, title: 'Skincare Myths Debunked', creator: '@SkinCarePro', velocity: 80, reach: '1.2M', engagement: '6.8%' },
            { rank: 5, title: 'Budget vs Luxury Makeup', creator: '@GlowUpDaily', velocity: 75, reach: '880K', engagement: '7.2%' }
        ];

        const mockHeatmap = {
            yourBrand: { qContent: 75, qReach: 68, qEngagement: 72 },
            competitor1: { name: 'Brand X', qContent: 82, qReach: 78, qEngagement: 80 },
            competitor2: { name: 'Brand Y', qContent: 65, qReach: 70, qEngagement: 68 }
        };

        async function checkAuth() {
            try {
                const { data: { user }, error } = await supabase.auth.getUser();
                if (error || !user) {
                    window.location.href = 'login.html';
                    return null;
                }

                // Check Partner tier
                const { data: subscription } = await supabase
                    .from('gv_subscriptions')
                    .select('tier_name, status')
                    .eq('user_id', user.id)
                    .eq('status', 'active')
                    .single();

                if (!subscription || subscription.tier_name !== 'partner') {
                    document.getElementById('radar-restriction-text').innerHTML =
                        '‚õî Radar requires Partner-tier subscription. <a href="pricing.html" style="color: #16A34A; font-weight: 600; text-decoration: underline;">Upgrade now</a>';
                    return null;
                }

                return user;
            } catch (err) {
                console.error('Auth check failed:', err);
                window.location.href = 'login.html';
                return null;
            }
        }

        function renderNewsFeed() {
            const html = mockNews.map(news => `
                <div class="news-item">
                    <div style="display: flex; align-items: start; gap: 12px;">
                        <span style="font-size: 24px; flex-shrink: 0;">${news.icon}</span>
                        <div style="flex: 1;">
                            <h4 style="font-weight: 700; font-size: 14px; margin-bottom: 4px;">${news.title}</h4>
                            <p style="font-size: 13px; color: #6B7280; margin-bottom: 8px;">${news.description}</p>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                ${news.trend ? `<span class="badge-${news.trend === 'up' ? 'success' : 'error'}-tailadmin">${news.value || news.rank}</span>` : ''}
                                ${news.change ? `<span class="badge-primary-tailadmin">${news.change}</span>` : ''}
                                ${news.impact ? `<span class="badge-warning-tailadmin">${news.impact} Impact</span>` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('news-feed').innerHTML = html;
        }

        function renderCreatorLeaderboard() {
            const html = mockCreators.map(creator => {
                const rankClass = creator.rank <= 3 ? `rank-${creator.rank}` : 'rank-default';
                return `
                    <div class="leaderboard-item">
                        <div class="rank-badge ${rankClass}">${creator.rank}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 700; font-size: 14px; margin-bottom: 4px;">${creator.name}</div>
                            <div style="font-size: 12px; color: #6B7280; margin-bottom: 8px;">${creator.category}</div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                                <div>
                                    <div style="font-size: 11px; color: #6B7280;">Quality Content</div>
                                    <div class="metric-bar"><div class="metric-fill" style="width: ${creator.qContent}%;"></div></div>
                                </div>
                                <div>
                                    <div style="font-size: 11px; color: #6B7280;">Quality Reach</div>
                                    <div class="metric-bar"><div class="metric-fill" style="width: ${creator.qReach}%;"></div></div>
                                </div>
                                <div>
                                    <div style="font-size: 11px; color: #6B7280;">Quality Engagement</div>
                                    <div class="metric-bar"><div class="metric-fill" style="width: ${creator.qEngagement}%;"></div></div>
                                </div>
                                <div>
                                    <div style="font-size: 11px; color: #6B7280;">Impact Rate</div>
                                    <div class="metric-bar"><div class="metric-fill" style="width: ${creator.impact}%;"></div></div>
                                </div>
                            </div>
                        </div>
                        <div style="font-size: 24px; font-weight: 700; color: #16A34A;">${creator.mindshare}</div>
                    </div>
                `;
            }).join('');
            document.getElementById('leaderboard-creators').innerHTML = html;
        }

        function renderContentLeaderboard() {
            const html = mockContent.map(content => {
                const rankClass = content.rank <= 3 ? `rank-${content.rank}` : 'rank-default';
                return `
                    <div class="leaderboard-item">
                        <div class="rank-badge ${rankClass}">${content.rank}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 700; font-size: 14px; margin-bottom: 4px;">${content.title}</div>
                            <div style="font-size: 12px; color: #6B7280; margin-bottom: 8px;">${content.creator}</div>
                            <div style="display: flex; gap: 12px; font-size: 12px;">
                                <span style="color: #6B7280;">Reach: <strong>${content.reach}</strong></span>
                                <span style="color: #6B7280;">Engagement: <strong>${content.engagement}</strong></span>
                            </div>
                        </div>
                        <div style="font-size: 24px; font-weight: 700; color: #16A34A;">${content.velocity}</div>
                    </div>
                `;
            }).join('');
            document.getElementById('leaderboard-content').innerHTML = html;
        }

        function renderHeatmap() {
            const getHeatColor = (value) => {
                if (value >= 80) return '#16A34A';
                if (value >= 70) return '#84CC16';
                if (value >= 60) return '#FACC15';
                if (value >= 50) return '#FB923C';
                return '#F87171';
            };

            const brands = [
                { name: 'Your Brand', ...mockHeatmap.yourBrand },
                mockHeatmap.competitor1,
                mockHeatmap.competitor2
            ];

            const html = `
                <div style="margin-bottom: 24px;">
                    ${brands.map((brand, idx) => `
                        <div style="margin-bottom: 16px;">
                            <h4 style="font-weight: 700; font-size: 14px; margin-bottom: 8px; ${idx === 0 ? 'color: #16A34A;' : ''}">${brand.name}</h4>
                            <div class="heatmap-grid">
                                <div class="heatmap-cell" style="background: ${getHeatColor(brand.qContent)};">
                                    <div style="font-size: 24px; font-weight: 700; color: white;">${brand.qContent}%</div>
                                    <div style="font-size: 12px; color: white; opacity: 0.9;">Quality Content</div>
                                </div>
                                <div class="heatmap-cell" style="background: ${getHeatColor(brand.qReach)};">
                                    <div style="font-size: 24px; font-weight: 700; color: white;">${brand.qReach}%</div>
                                    <div style="font-size: 12px; color: white; opacity: 0.9;">Quality Reach</div>
                                </div>
                                <div class="heatmap-cell" style="background: ${getHeatColor(brand.qEngagement)};">
                                    <div style="font-size: 24px; font-weight: 700; color: white;">${brand.qEngagement}%</div>
                                    <div style="font-size: 12px; color: white; opacity: 0.9;">Quality Engagement</div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            document.getElementById('heatmap-container').innerHTML = html;
        }

        async function initRadar() {
            const user = await checkAuth();
            if (!user) return;

            renderNewsFeed();
            renderCreatorLeaderboard();
            renderContentLeaderboard();
            renderHeatmap();
        }

        initRadar();
        console.log('GeoVera Radar Ready - KaitoAI Style');
    </script>
</body>
</html>
